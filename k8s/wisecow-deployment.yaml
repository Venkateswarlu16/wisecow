# k8s/wisecow-deployment.yaml (single file: Namespace, Deployment, Service, Ingress)
apiVersion: v1
kind: Namespace
metadata:
  name: wisecow
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: wisecow
  namespace: wisecow
  labels: { app: wisecow }
spec:
  replicas: 2
  selector: { matchLabels: { app: wisecow } }
  template:
    metadata: { labels: { app: wisecow } }
    spec:
      containers:
      - name: wisecow
        image: venkateswarlu16/wisecow:latest
        imagePullPolicy: IfNotPresent
        ports: [{ containerPort: 4499 }]
        readinessProbe:
          tcpSocket: { port: 4499 }
          initialDelaySeconds: 3
          periodSeconds: 5
        livenessProbe:
          tcpSocket: { port: 4499 }
          initialDelaySeconds: 15
          periodSeconds: 20
---
apiVersion: v1
kind: Service
metadata: { name: wisecow-service, namespace: wisecow }
spec:
  selector: { app: wisecow }
  ports: [{ protocol: TCP, port: 80, targetPort: 4499 }]
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata: { name: wisecow-ingress, namespace: wisecow }
spec:
  ingressClassName: nginx
  tls:
    - hosts: [ "wisecow.local" ]
      secretName: wisecow-tls
  rules:
    - host: wisecow.local
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service: { name: wisecow-service, port: { number: 80 } }
